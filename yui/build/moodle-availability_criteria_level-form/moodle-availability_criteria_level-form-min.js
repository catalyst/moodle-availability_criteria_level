YUI.add("moodle-availability_criteria_level-form",function(r,e){M.availability_criteria_level=M.availability_criteria_level||{},M.availability_criteria_level.form=r.Object(M.core_availability.plugin),M.availability_criteria_level.form.gradeitems=null,M.availability_criteria_level.form.initInner=function(e){this.gradeitems=e},M.availability_criteria_level.form.getNode=function(e){for(var i,l,a='<label class="form-group"><span class="p-r-1">Grade Item</span> <span class="availability-criterion"><select name="gradeitemid" class="custom-select"><option value="0">'+M.util.get_string("choosedots","moodle")+"</option>",t=0;t<this.gradeitems.length;t++)a+='<option value="'+(i=this.gradeitems[t]).id+'">'+i.name+"</option>";return a=(a=(a+="</select></span></label>")+('<label><span class="p-r-1">'+M.util.get_string("choosecriteria","availability_criteria_level")+'</span> <span class="availability-criteria_level"><select name="criterion" class="custom-select"><option value="choose">'+M.util.get_string("choosedots","moodle")+"</option></select></span></label>"))+('<label><span class="p-r-1">'+M.util.get_string("chooselevel","availability_criteria_level")+'</span> <span class="availability-criteria_level"><select name="level" class="custom-select"><option value="choose">'+M.util.get_string("choosedots","moodle")+"</option></select></span></label>"),l=r.Node.create('<span class="form-inline">'+a+"</span>"),e.creating===undefined&&(e.gradeitemid!==undefined&&l.one("select[name=gradeitemid] > option[value="+e.gradeitemid+"]")?(l.one("select[name=gradeitemid]").set("value",""+e.gradeitemid),M.availability_criteria_level.fillCriterion(l)):e.gradeitemid===undefined&&l.one("select[name=gradeitemid]").set("value","choose"),e.criterion!==undefined&&l.one("select[name=criterion] > option[value="+e.criterion+"]")?(l.one("select[name=criterion]").set("value",""+e.criterion),M.availability_criteria_level.fillLevels(l)):e.criterion===undefined&&l.one("select[name=criterion]").set("value","choose"),e.level!==undefined&&l.one("select[name=level] > option[value="+e.level+"]")?l.one("select[name=level").set("value",""+e.level):e.level===undefined&&l.one("select[name=level]").set("value","choose")),M.availability_criteria_level.form.addedEvents||(M.availability_criteria_level.form.addedEvents=!0,l.one("select[name=gradeitemid]").delegate("change",function(){M.availability_criteria_level.fillCriterion(l),M.core_availability.form.update()},".availability_criteria_level select"),l.one("select[name=criterion]").delegate("change",function(){M.availability_criteria_level.fillLevels(l),M.core_availability.form.update()},".availability_criteria_level select"),l.one("select[name=level]").delegate("change",function(){M.core_availability.form.update()},".availability_criteria_level select")),l},M.availability_criteria_level.form.fillValue=function(e,i){var l=i.one("select[name=gradeitemid]").get("value");e.gradeitemid="choose"===l?"choose":parseInt(l,10),l=i.one("select[name=criterion]").get("value"),e.criterion="choose"===l?"":parseInt(l,10),l=i.one("select[name=level]").get("value"),e.level="choose"===l?"":parseInt(l,10)},M.availability_criteria_level.form.fillErrors=function(e,i){var l={};this.fillValue(l,i),(l.gradeitemid&&"choose"===l.gradeitemid||l.criterion&&"choose"===l.criterion||l.level&&"choose"===l.level)&&e.push("availability_criteria_level:error_selectcriterion")},M.availability_criteria_level.fillCriterion=function(e){var i,l,a,v,t,r,o,n,c,s=e.one("select[name=gradeitemid]").get("value");if("choose"!==s){for(i=parseInt(s,10),l=null,a=0;a<M.availability_criteria_level.form.gradeitems.length;a++)if((v=M.availability_criteria_level.form.gradeitems[a]).id==i){l=v;break}if(null!==l){for(r=(t=e.one("select[name=criterion]").getDOMNode()).options.length-1;0<=r;r--)t.remove(r);for((s=document.createElement("option")).value="choose",s.text=M.util.get_string("choosedots","moodle"),t.add(s),o=0;o<l.criteria.length;o++)n=l.criteria[o],(c=document.createElement("option")).value=n.id,c.text=n.description,t.add(c)}}},M.availability_criteria_level.fillLevels=function(e){var v,i,l,d,a,t,r,o,n,c,s,m=e.one("select[name=criterion]").get("value");if("choose"!==m){for(v=parseInt(e.one("select[name=gradeitemid]").get("value"),10),i=null,l=0;l<M.availability_criteria_level.form.gradeitems.length;l++)if((d=M.availability_criteria_level.form.gradeitems[l]).id==v){i=d;break}for(a=null,t=0;t<i.criteria.length;t++)i.criteria[t].id==parseInt(m,10)&&(a=i.criteria[t]);for(o=(r=e.one("select[name=level]").getDOMNode()).options.length-1;0<=o;o--)r.remove(o);for((e=document.createElement("option")).value="choose",e.text=M.util.get_string("choosedots","moodle"),r.add(e),n=0;n<a.levels.length;n++)c=a.levels[n],(s=document.createElement("option")).value=c.id,s.text=c.definition,r.add(s)}}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});